<!DOCTYPE html>
<html>

<head>
    <meta name="viewport" content="width=device-width" , initial-scale="1.0" />
    <meta charset="utf-8" />
    <title> éš¨æ©Ÿåˆ†çµ„ </title>
    <style>
        .btn {
            background-color: #ffcccc;
            padding: 5px;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 10px;
        }

        .title {
            margin: 10px;
            text-align: center;
            font-size: 1cm;
        }

        .notClickCss {
            pointer-events: none;
            cursor: not-allowed;
            background-color: #FFF0F5;
            margin-top: 10px;
        }

        .container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-items: flex-start;
            padding: 10px;
        }

        .box {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 10px;
            width: 30%;
            min-width: 200px;
            box-sizing: border-box;
        }

        @media (max-width: 1100px) {
            .box {
                width: 50%;
                margin: 5px 0;
            }
        }

        @media (max-width: 800px) {
            .box {
                width: 100%;
                margin: 5px 0;
            }
        }

        #imgLove {
            display: none;
            max-width: 100%;
            height: auto;
            max-height: 100%;
            object-fit: contain;
        }

        .img-container {
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .textareaInput {
            width: 100%;
            max-width: 600px;
            resize: none;
            box-sizing: border-box;
        }

        .textareaCss {
            resize: none;
            max-width: 600px;
        }

        .smallTitle {
            margin-bottom: 10px;
            margin-bottom: 10px;
        }
    </style>
</head>

<body>
    <div class="title">
        éš¨æ©Ÿåˆ†çµ„
    </div>
    <div style="text-align:center;">
        <textarea name="" id="text" cols="80" rows="10" class="textareaInput" placeholder="âœ¨è«‹è¼¸å…¥åç¨±âœ¨
âœ¨ä¸€è¡Œä¸€å€‹åå­—âœ¨
å°é›
å°æ¯›
å°å¥‡
å°é’è›™
å°ç†Šè²“">
å°é›
å°æ¯›
å°å¥‡
å°é’è›™
å°ç†Šè²“
</textarea>
    </div>
    <div style="text-align:center;">
        <div>
            <span>ç›®å‰å…±è¼¸å…¥</span><span id="displayNameAmount">5</span><span>å€‹åå­—</span>
        </div>
        <div style="padding:10px;">
            åˆ†çµ„æ•¸é‡ï¼š<input id="amount" type="number" value="2" step="1" min="2" required>
        </div>
        <div style="padding:10px">
            <span onclick="random()" class="btn" id="randomId">éš¨æ©Ÿåˆ†çµ„</span>
            <span onclick="empty()" class="btn" id="emptyId">æ¸…ç©º</span>
        </div>
    </div>
    <hr>
    <div class="title">
        åˆ†çµ„çµæœ
    </div>
    <p></p>
    <div class="container">
        <span class="box">
            <span class="smallTitle">ä¸€çµ„ä¸€æ®µè½å‘ˆç¾</span>
            <textarea name="" id="result" cols="40%" rows="10" class="textareaCss"></textarea>
            <span onclick="clone()" class="notClickCss" id="copy">è¤‡è£½çµæœ</span>
        </span>
        <span class="box">
            <span class="smallTitle">ä¸€åå­—ä¸€è¡Œå‘ˆç¾</span>
            <textarea name="" id="result2" cols="40%" rows="10" class="textareaCss"></textarea>
            <span onclick="clone2()" class="notClickCss" id="copy2">è¤‡è£½çµæœ</span>
        </span>
        <span class="box">
            <span class="smallTitle">æˆ‘å°ä½ çš„æ„›çš„å‘ˆç¾</span>
            <div class="img-container">
                <img id="imgLove">
            </div>
            <textarea name="" id="result3" cols="40%" rows="10" class="textareaCss" placeholder="æœŸå¾…ä¸€ä¸‹å…«w
æœŸå¾…ä¸€ä¸‹8w
æœŸå¾…ä¸€ä¸‹baw
æœŸå¾…ä¸€ä¸‹ãƒw
æœŸå¾…ä¸€ä¸‹ë°”w
æœŸå¾…ä¸€ä¸‹å§w"></textarea>
            <span class="notClickCss" id="copy3">è¤‡è£½çµæœ</span>
        </span>
    </div>

    <script>
        // åˆ†çµ„æ•¸é‡å¦‚æœå¤§æ–¼åå­—æ•¸é‡ å‰‡ä¸å¯æŒ‰ä¸‹éš¨æ©Ÿåˆ†çµ„æŒ‰éˆ•
        function TextAndAmount(event) {
            // åˆ†çµ„æ•¸é‡
            let inputAmount = document.querySelector("#amount").value;
            // ä»¥æ›è¡Œç‚ºåˆ†éš” æ‹†åˆ†æˆé™£åˆ—
            let splitTexts = document.querySelector("#text").value.split(/\r|\r\n|\n/)
            for (i = 0; i < splitTexts.length; i++) {
                // å»æ‰ç©ºå€¼ || å»æ‰é‡è¤‡å€¼
                if (splitTexts[i] == '' || splitTexts.indexOf(splitTexts[i]) != i) {
                    splitTexts.splice(i, 1);
                    // å»æ‰ä¹‹å¾Œé™£åˆ—é•·åº¦æœƒæ”¹è®Š iéœ€-1 ä»¥ç¢ºä¿æ¯å€‹ä½ç½®éƒ½æœ‰é€²å…¥è¿´åœˆ
                    i--;
                }
            }
            // åå­—æ•¸é‡
            let rows = splitTexts.length
            //ã€€é¡¯ç¤ºåœ¨ç•«é¢ä¸Š ç›®å‰å·²æœ‰rowså€‹åå­—
            document.querySelector("#displayNameAmount").innerHTML = rows;
            let randomBtn = document.querySelector("#randomId");
            // åå­—æ•¸é‡>=2 && åå­—æ•¸é‡=>åˆ†çµ„æ•¸é‡ && åˆ†çµ„æ•¸é‡>=2ï¼Œè‹¥ç‚ºæ˜¯ å‰‡è®Šæ›´"éš¨æ©Ÿåˆ†çµ„"æŒ‰éˆ•çš„æ¨£å¼ç‚ºbtn
            if (rows >= 2 && rows >= inputAmount && inputAmount >= 2) {
                randomBtn.classList.remove("notClickCss");
                randomBtn.classList.add("btn");
            } else {
                // è‹¥ç‚ºé å‰‡è®Šæ›´"éš¨æ©Ÿåˆ†çµ„"æŒ‰éˆ•çš„æ¨£å¼ç‚ºnotClickCss
                randomBtn.classList.remove("btn");
                randomBtn.classList.add("notClickCss");
            }
        }
        document.getElementById("text").addEventListener("input", TextAndAmount);
        document.getElementById("amount").addEventListener("input", TextAndAmount);

        // éš¨æ©Ÿåˆ†çµ„æŒ‰éˆ•
        function random() {
            let inputAmount = document.querySelector("#amount").value;
            // æŠŠåå­—ä»¥æ›è¡Œç‚ºåˆ†éš” æ‹†åˆ†æˆé™£åˆ—
            let splitTexts = document.querySelector("#text").value.split(/\r|\r\n|\n/)
            for (i = 0; i < splitTexts.length; i++) {
                // å»æ‰ç©ºå€¼ || å»æ‰é‡è¤‡å€¼
                if (splitTexts[i] == '' || splitTexts.indexOf(splitTexts[i]) != i) {
                    splitTexts.splice(i, 1);
                    // å»æ‰ä¹‹å¾Œé™£åˆ—é•·åº¦æœƒæ”¹è®Š iéœ€-1 ä»¥ç¢ºä¿æ¯å€‹ä½ç½®éƒ½æœ‰é€²å…¥è¿´åœˆ
                    i--;
                }
            }
            // åå­—æ•¸é‡
            let rows = splitTexts.length
            // æ¯çµ„çš„åå­—æ•¸é‡ï¼šåå­—æ•¸é‡/åˆ†çµ„æ•¸é‡
            let groupAmount = Math.floor(splitTexts.length / inputAmount)
            // éš¨æ©Ÿæ‰“äº‚é™£åˆ—é †åºçš„å‡½æ•¸
            let shuffleArray = arr => arr.sort(() => 0.5 - Math.random());
            // æŠŠåå­—æ”¾å…¥shuffleArrayå‡½æ•¸ å–å¾—æ‰“äº‚é †åºçš„åå­—é™£åˆ—
            let final = shuffleArray(splitTexts);
            // è¨­ä¸€å€‹ç©ºé™£åˆ— æ‹¿ä¾†å„²å­˜greetå‡½æ•¸è·‘å®Œçš„çµæœ
            let finalArr = []
            // å¾æ‰“äº‚çš„é™£åˆ—æŠŠåå­—æ‹¿å‡º ä¾åºæ”¾å…¥çµ„åˆ¥
            function greet() {
                for (i = 0; i < inputAmount; i++) {
                    let breakCount = 0;
                    for (j = 0; j < groupAmount; j++) {
                        // åå­—æ”¾å…¥æ•¸é‡ >= æ¯çµ„çš„åå­—æ•¸é‡ å‰‡ä¸­æ–·å…§å±¤è¿´åœˆ ç¹¼çºŒä¸‹ä¸€å€‹è¿´åœˆ
                        if (breakCount >= groupAmount) {
                            break;
                        }
                        // æŠŠã€ç¬¬Xçµ„ï¼šã€‘å’Œã€final[j]ã€‘å’Œã€ã€ã€‘æ”¾å…¥é™£åˆ— âœ¨ğŸ¤¯åˆä½µå•é¡Œ
                        let temp = "ç¬¬" + (i + 1) + "çµ„ï¼š";
                        let temp2 = final[j];
                        finalArr.push(temp);
                        finalArr.push(temp2 + "ã€");
                        // è¨ˆç®—æ¯çµ„å·²æ”¾å…¥çš„åå­—æ•¸é‡
                        breakCount += 1;
                        // æŠŠå·²åŠ å…¥çµ„åˆ¥çš„åå­—åˆªé™¤ å¦å‰‡ç•¶i=2 é€²å…¥å…§å±¤è¿´åœˆåˆå¾j=0é–‹å§‹è·‘ æœƒæŠŠå·²ç¶“è¢«åˆ†é…çµ„åˆ¥çš„åå­—æœƒå†æ¬¡è¢«åˆ†é…
                        final.splice(j, 1);
                        // å› ç‚ºåˆªæ‰äº† æ‰€ä»¥-1 ç¢ºä¿æŒ‰ç…§é™£åˆ—é †åºåˆ†é…
                        j--;
                    }
                }
                return finalArr;
            }
            greet();
            // çµ„åˆ¥æ•¸é‡*æ¯çµ„æˆå“¡æ•¸é‡!=åå­—æ•¸é‡ finalå°±ä¸æœƒè¢«æ”¾å®Œ 
            // æ¯çµ„æ•¸é‡=2 æ¯çµ„åªèƒ½æ”¾å…¥2å€‹ åˆ†å…©çµ„ ä½†æˆå“¡æ•¸é‡æœ‰5å€‹ æœƒæœ‰ä¸€å€‹è¢«å‰©ä¸‹ finalè£¡å°±æ˜¯è¢«å‰©ä¸‹çš„å€¼
            // åœ¨ã€ç¬¬Xçµ„ï¼šã€‘å¾Œæ’å…¥finalçš„å€¼ æ‰€ä»¥è¦å…ˆå»é‡ ä¸ç„¶é‡è¤‡çš„ã€ç¬¬Xçµ„ã€‘å¾Œé¢æ‰å»é‡çš„è©± çµ„åˆ¥åæœƒæ¶ˆå¤± è¢«åˆ†é…åˆ°ä¸å°çš„çµ„åˆ¥çµæœ
            let tpp = 0;
            finalArr = [...new Set(finalArr)]
            if (final != []) {
                for (j = 0; j < finalArr.length; j++) {
                    let regex = /ç¬¬\d+çµ„ï¼š/;
                    // å¦‚æœåœ¨finalArrçš„ç¬¬jå€‹ä½ç½®æœ‰æ‰¾åˆ°regexçš„å€¼ è€Œä¸”tppå°æ–¼ç­‰æ–¼finalçš„é•·åº¦-1
                    if (regex.test(finalArr[j]) && tpp <= final.length - 1) {
                        // åœ¨finalArrçš„ç¬¬j+1å€‹ä½ç½®æ’å…¥finalçš„å€¼
                        finalArr.splice(j + 1, 0, final[tpp] + "ã€")
                        tpp++;
                    }
                }
            }
            let temps = finalArr.join('');
            let indexArr = []
            // è·³éç¬¬ä¸€å€‹"ç¬¬"
            let q = 2;
            while (q < temps.length) {
                // indexfinal = "ç¬¬"çš„ä½ç½®
                let indexfinal = temps.indexOf("ç¬¬", q);
                // å¦‚æœ"ç¬¬"æœ‰è¢«æ‰¾åˆ° è€Œä¸” "ç¬¬"çš„ä½ç½®æ˜¯ç¬¬ä¸€æ¬¡è¢«æ‰¾åˆ°
                if (indexfinal != -1 && indexArr.includes(indexfinal) == false) {
                    function insertStr(soure, start, newStr) {
                        return temps.slice(0, indexfinal) + "\n" + temps.slice(indexfinal);
                    }
                    // å‘¼å«insertStrå‡½æ•¸ æŠŠtemps å¾indexfinalé€™å€‹ä½ç½®åˆ‡é–‹ æ’å…¥æ›è¡Œ å†è£œå›ä¾†åˆ‡é–‹å¾Œindexfinalå¾Œé¢å‰©ä¸‹çš„
                    temps = insertStr(temps, indexfinal, "\n");
                    // æ›´æ–°æ‰¾åˆ°çš„"ç¬¬"çš„ä½ç½® åœ¨æ’å…¥æ›è¡Œä¹‹å¾Œ "ç¬¬"çš„ä½ç½®ç‚ºåŸæ‰¾åˆ°çš„ä½ç½®+1
                    indexArr.push(indexfinal + 1);
                }
                // å¦‚æœè¢«æ‰¾åˆ°"ç¬¬"çš„ä½ç½®çš„é™£åˆ—é•·åº¦ ç­‰æ–¼ åˆ†çµ„æ•¸é‡-1 
                // å› ç‚ºè·³éç¬¬ä¸€å€‹"ç¬¬" æ‰€ä»¥åªæœƒæ‰¾åˆ°(åˆ†çµ„æ•¸é‡-1)å€‹"ç¬¬" çµæŸè¿´åœˆ
                if (indexArr.length == inputAmount - 1) {
                    break;
                }
                // ä¸‹ä¸€å€‹è¿´åœˆçš„q ç›´æ¥å¾ "ç¬¬"çš„ä½ç½®+1å†+1(å› ç‚ºæ›è¡Œ é•·åº¦æœƒå¢åŠ )
                q = indexfinal + 2;
            }
            // æŠŠæ¯çµ„æœ€å¾Œä¸€å€‹é “è™Ÿåˆªæ‰ æ”¹æˆæ›è¡Œ
            temps = temps.replace(/ã€\n/g, '\n\n');
            // åˆªé™¤æ•´å€‹å­—ä¸²è¡Œæœ«çš„é “è™Ÿ
            temps = temps.replace(/ã€$/gm, '');
            document.getElementById('result').value = temps;
            handleInputEventCopy();
            // ä¸€åå­—ä¸€è¡Œå‘ˆç¾
            for (let i = 0; i < temps.length; i++) {
                // å¦‚æœtemps[i]æ˜¯é “è™Ÿ å‰‡æŠŠé “è™Ÿæ›¿æ›æˆæ›è¡Œ
                if (temps[i] == "ã€") {
                    temps = temps.replace(temps[i], "\n");
                    // å¦‚æœtemps[i]æ˜¯å†’è™Ÿ å‰‡æ’å…¥æ›è¡Œ
                } else if (temps[i] == "ï¼š") {
                    function insertStr(str, index, newStr) {
                        return str.slice(0, index + 1) + newStr + str.slice(index + 1)
                    }
                    temps = insertStr(temps, i, "\n")
                }
            }
            document.getElementById('result2').value = temps;
            handleInputEventCopy();

            let catText = document.querySelector("#copy3")
            let imgCat = document.querySelector("#imgLove")
            if (catText.innerHTML == "è¤‡è£½çµæœ") {
                // ç§»é™¤textareaæ¨™ç±¤
                document.querySelector("#result3").remove();
                // æŠŠimgLoveçš„æ”¹ç‚ºé¡¯ç¤º
                imgCat.style.display = "block";
                // æŠŠç¬¬ä¸‰å€‹"è¤‡è£½çµæœ"çš„æŒ‰éˆ• æ”¹æ–‡å­—å…§å®¹ æ”¹èƒŒæ™¯é¡è‰²
                catText.innerHTML = "âœ¨å› ç‚ºè²“è²“å¯æ„›æ‰€ä»¥åˆ†äº«çµ¦ä½ (âÂ´â—¡`â)âœ¨"
                catText.style.background = "#FFFF00"
            }
            // åœ¨imgæ”¾å…¥åœ–ç‰‡ æ¯æ¬¡æŒ‰éš¨æ©Ÿåˆ†çµ„çš„æŒ‰éˆ• éƒ½æœƒéš¨æ©Ÿæ›è²“å’ªçš„ç…§ç‰‡
            function changeImg() {
                imgCat.src = "p7-cat" + Math.ceil(Math.random() * 6) + ".jpg";
            };
            changeImg();
        }

        // "æ¸…ç©º"æŒ‰éˆ•
        function empty() {
            let all = document.querySelector("#text");
            let notClick1 = document.querySelector("#randomId")
            if (confirm(("ç¢ºå®šè¦æ¸…ç©º?!...?!")) == true) {
                all.value = "";
                handleInputEventCopy();
                TextAndAmount();
            }
        }

        // å¦‚æœçµæœ1å’Œçµæœ2çš„æ–‡å­—æ¡†ç‚ºç©º å‰‡ä¸å¯æŒ‰ä¸‹"è¤‡è£½çµæœ"æŒ‰éˆ•
        function handleInputEventCopy(event) { //  function handleInputEventCopy(event, checkTarget = null)  checkTargetåƒæ•¸çš„é è¨­å€¼ç‚ºnull ç•¶å‘¼å«handleInputEventCopyæ²’æœ‰çµ¦åƒæ•¸æ™‚ å‰‡checkTargetç‚ºnull // checkTargetç”¨ä¾†æŒ‡å®šè¦è¢«æª¢æŸ¥çš„å…ƒç´  è€Œä¸æœƒæ¯å€‹å…ƒç´ éƒ½æª¢æŸ¥
            // å¦‚æœçµæœ1çš„æ–‡å­—æ¡†ç‚ºç©º å‰‡ä¸å¯æŒ‰ä¸‹"è¤‡è£½çµæœ"æŒ‰éˆ•
            let all = document.querySelector("#result");
            let notClick3 = document.querySelector("#copy")
            if (all.value == "") {
                notClick3.classList.remove("btn");
                notClick3.classList.add("notClickCss");
            } else {
                notClick3.classList.remove("notClickCss");
                notClick3.classList.add("btn");
            }
            // å¦‚æœçµæœ2çš„æ–‡å­—æ¡†ç‚ºç©º å‰‡ä¸å¯æŒ‰ä¸‹"è¤‡è£½çµæœ"æŒ‰éˆ•
            let allCopy2 = document.querySelector("#result2");
            let notClickCopy2 = document.querySelector("#copy2")
            if (allCopy2.value == "") {
                notClickCopy2.classList.remove("btn");
                notClickCopy2.classList.add("notClickCss");
            } else {
                notClickCopy2.classList.remove("notClickCss");
                notClickCopy2.classList.add("btn");
            }
            // å¦‚æœè¼¸å…¥æ¡†ç‚ºç©º å‰‡ä¸å¯æŒ‰ä¸‹"æ¸…ç©º"æŒ‰éˆ• åä¹‹å¯æŒ‰ä¸‹"æ¸…ç©º"æŒ‰éˆ•
            let allText = document.querySelector("#text");
            let notClickText = document.querySelector("#emptyId")
            if (allText.value == "") {
                notClickText.classList.remove("btn");
                notClickText.classList.add("notClickCss");
            } else {
                notClickText.classList.remove("notClickCss");
                notClickText.classList.add("btn");
            }
        }
        document.querySelector("#result").addEventListener("input", handleInputEventCopy);
        document.querySelector("#result2").addEventListener("input", handleInputEventCopy);
        document.querySelector("#text").addEventListener("input", handleInputEventCopy);

        // ä¸€çµ„ä¸€æ®µè½å‘ˆç¾ "è¤‡è£½çµæœ"æŒ‰éˆ•
        function clone() {
            let btnCopy = document.querySelector("#result")
            btnCopy.select();
            document.execCommand('copy');
            alert("è¤‡è£½æˆåŠŸ");
        }

        // ä¸€åå­—ä¸€è¡Œå‘ˆç¾ "è¤‡è£½çµæœ"æŒ‰éˆ•
        function clone2() {
            let btnCopy = document.querySelector("#result2")
            btnCopy.select();
            document.execCommand('copy');
            alert("è¤‡è£½æˆåŠŸ");
        }

    </script>

</body>

</html>
<!-- function handleInputEventCopy(event) {
    let allText = document.querySelector("#text");
    let allCopy1 = document.querySelector("#result");
    let allCopy2 = document.querySelector("#result2");
    let notClickText = document.querySelector("#emptyId")
    let notClickCopy1 = document.querySelector("#copy");
    let notClickCopy2 = document.querySelector("#copy2");
    if (allCopy1.value == "" || allCopy2.value == "" || allText.value == "") {
        notClickText.classList.remove("btn");
        notClickText.classList.add("notClickCss");
        notClickCopy1.classList.remove("btn");
        notClickCopy1.classList.add("notClickCss");
        notClickCopy2.classList.remove("btn");
        notClickCopy2.classList.add("notClickCss");
    } else {
        notClickText.classList.remove("notClickCss");
        notClickText.classList.add("btn");
        notClickCopy1.classList.remove("notClickCss");
        notClickCopy1.classList.add("btn");
        notClickCopy2.classList.remove("notClickCss");
        notClickCopy2.classList.add("btn");
    }
}
document.querySelector("#text").addEventListener("input", handleInputEventCopy);
document.querySelector("#result").addEventListener("input", handleInputEventCopy);
document.querySelector("#result2").addEventListener("input", handleInputEventCopy); -->